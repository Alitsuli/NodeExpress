<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="../style/style.css" type="text/css" rel="stylesheet" />
    <title>Tehtävä 6</title>
</head>
<body>
    <input type="date" id="startDate">
    <input type="date" id="endDate">
    <button type="button" id="submitButton">Find</button>
<div id="data">
    <ul id="datalist">
    </ul>
</div>
</body>

<script>
    function strReplace(myStr){
        return myStr.replace(/-/g, "");
    }
    document.getElementById("submitButton").addEventListener("click", function(){

        let startDate = strReplace(document.getElementById("startDate").value.toString());
        let endDate = strReplace(document.getElementById("endDate").value.toString());
        let url = 'http://localhost:8081/api/events?start=' + startDate + '&end=' + endDate;

        if(startDate !== "" && endDate !== "") {
            fetch(url).then(function(response) {
                return response.json();
            }).then(function(data) {
                console.log(JSON.stringify(data));
                console.log(data.length);

                for(let i = 0; i < data.length; i++){
                    let datalist = document.getElementById("datalist");
                    let ulname = document.createElement("li");
                    ulname.innerHTML = data[i].Name;
                    datalist.appendChild(ulname);
                    let uldate = document.createElement("li");
                    uldate.innerHTML = data[i].Date;
                    datalist.appendChild(uldate);
                    let ultype = document.createElement("li");
                    ultype.innerHTML = data[i].Type;
                    datalist.appendChild(ultype);
                    let ullocation = document.createElement("li");
                    ullocation.innerHTML = data[i].Location_name;
                    datalist.appendChild(ullocation);
                }
            }).catch(function(error) {
                console.error(error);
            });
        }
    });
</script>

</html>